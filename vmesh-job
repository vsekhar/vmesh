#upstart-job

description "Vmesh upstart job"
author "Vivek Sekhar <vivek@viveksekhar.ca>"

start on stopped cloud-final
stop on shutdown

#exec /usr/bin/twistd -n -u ubuntu -g ubuntu --syslog vmesh

script
easy_install /var/lib/vmesh/vmesh.egg

python <<EOF
from twisted.plugin import IPlugin, getPlugins
list(getPlugins(IPlugin))
EOF

/usr/bin/twistd -n -u ubuntu -g ubuntu --syslog --pidfile=/dev/null vmesh --config-file=/var/lib/vmesh/config

end script

